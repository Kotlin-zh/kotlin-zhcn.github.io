<html>
<head>
<meta charset="utf-8">

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5P98');</script>
<!-- End Google Tag Manager -->


<title>Kotlin Android Extensions - Kotlin 编程语言</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<link rel="Shortcut Icon" href="/assets/images/favicon.ico" type="image/x-icon"/>
<link rel="apple-touch-icon" href="/assets/images/apple-touch-icon.png"/>
<link rel="apple-touch-icon" sizes="72x72"
      href="/assets/images/apple-touch-icon-72x72.png"/>
<link rel="apple-touch-icon" sizes="114x114"
      href="/assets/images/apple-touch-icon-114x114.png"/>
<link rel="apple-touch-icon" sizes="144x144"
      href="/assets/images/apple-touch-icon-144x144.png"/>
<link rel="stylesheet" href="/0_assets/styles.css">


<!-- Social Media tag Starts -->
<!-- Place this data between the <head> tags of your website -->
<!-- Open Graph data -->
<meta property="og:title" content="Kotlin Android Extensions - Kotlin 编程语言"/>
<meta property="og:type" content="website"/>
<meta property="og:url" content="https://kotlinlang.org/docs/tutorials/android-plugin.html"/>
<meta property="og:image" content="https://kotlinlang.org/assets/images/open-graph/kotlin_250x250.png"/>
    <meta property="og:description" content="This tutorial describes how to use Kotlin Android Extensions to improve support for Android development.">
<meta property="og:site_name" content="Kotlin"/>

<!-- Twitter Card data -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@kotlin">
<meta name="twitter:title" content="Kotlin Android Extensions - Kotlin 编程语言">
    <meta name="twitter:description" content="This tutorial describes how to use Kotlin Android Extensions to improve support for Android development.">
<meta name="twitter:image:src" content="https://kotlinlang.org/assets/images/twitter-card/kotlin_800x320.png">
<!-- Social Media tag Ends -->
    <script src="/0_assets/default.js"></script>
    <script src="/0_assets/common.js"></script>
    <link rel="stylesheet" href="/0_assets/common.css"/>
</head>
<body>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5P98"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

<div class="global-layout">

<header class="global-header">

    <div class="global-header-panel">
        <div class="g-layout">
            <a class="global-header-logo" href="/">Kotlin</a>
<nav role="navigation" class="global-nav">

    <div class="nav-links">

            <a href="/docs/reference/"
               class="nav-item "
            >
                学习
            </a>

            <a href="/community/"
               class="nav-item "
            >
                社区
            </a>

            <a href="http://try.kotlinlang.org"
               class="nav-item "
            >
                在线试用
            </a>
    </div>


<div id="global-search" class=" global-search" title="Search">
    <div class="search-button">
        <div class="icon"></div>
    </div>
    <div class="search-box">
        <div class="gcse-searchbox-only"
             data-resultsUrl="/search.html"
             data-newWindow="false"
        ></div>
    </div>
</div></nav>        </div>
    </div>

    <div class="g-layout">
    </div>
</header>
    <div class="g-layout global-content">

    <nav role="navigation" class="docs-nav">
            <div class="nav-item-wrap">
                    <a href="/docs/reference/" class="nav-item">
                    <span class="nav-item-text">
                        参考
                    </span>
                    </a>

            </div>
            <div class="nav-item-wrap">
                    <a href="/docs/tutorials/" class="nav-item is_active">
                        <span class="nav-item-text">
                            教程
                        </span>
                    </a>
            </div>
            <div class="nav-item-wrap">
                    <a href="/docs/videos.html" class="nav-item">
                    <span class="nav-item-text">
                        视频
                    </span>
                    </a>

            </div>
            <div class="nav-item-wrap">
                    <a href="/docs/resources.html" class="nav-item">
                    <span class="nav-item-text">
                        更多资源
                    </span>
                    </a>

            </div>
    </nav>

    <div class="g-grid">
        <aside class="g-3">
            <div class="js-side-tree-nav">
                    <nav role="navigation" class="side-tree-nav">
            <div class="tree-item tree-branch js-item js-branch _closed"
                 data-id="开始">

                <div class="tree-item-title tree-branch-title js-item-title js-branch-title">
                    <div class="marker"></div>
                    <div class="text">开始</div>
                </div>

                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/docs/tutorials/getting-started.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">从 IntelliJ IDEA 入门</span>
                            </a>
                    </div>
                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/docs/tutorials/getting-started-eclipse.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">从 Eclipse 入门</span>
                            </a>
                    </div>
                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/docs/tutorials/command-line.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">使用命令行编译器</span>
                            </a>
                    </div>
                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/docs/tutorials/build-tools.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">使用构建工具</span>
                            </a>
                    </div>
                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/docs/tutorials/koans.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">心印</span>
                            </a>
                    </div>

            </div>
            <div class="tree-item tree-branch js-item js-branch _closed"
                 data-id="Java 互操作">

                <div class="tree-item-title tree-branch-title js-item-title js-branch-title">
                    <div class="marker"></div>
                    <div class="text">Java 互操作</div>
                </div>

                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/docs/tutorials/mixing-java-kotlin-intellij.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">在一个项目中混用 Java 和 Kotlin</span>
                            </a>
                    </div>

            </div>
            <div class="tree-item tree-branch js-item js-branch _closed"
                 data-id="JavaScript">

                <div class="tree-item-title tree-branch-title js-item-title js-branch-title">
                    <div class="marker"></div>
                    <div class="text">JavaScript</div>
                </div>

                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/docs/tutorials/javascript/kotlin-to-javascript/kotlin-to-javascript.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">Kotlin 转 JavaScript</span>
                            </a>
                    </div>
                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/docs/tutorials/javascript/getting-started-gradle/getting-started-with-gradle.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">以 Gradle 入门</span>
                            </a>
                    </div>
                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/docs/tutorials/javascript/getting-started-idea/getting-started-with-intellij-idea.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">以 IntelliJ IDEA 入门</span>
                            </a>
                    </div>
                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/docs/tutorials/javascript/getting-started-maven/getting-started-with-maven.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">以 Maven 入门</span>
                            </a>
                    </div>
                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/docs/tutorials/javascript/getting-started-command-line/command-line-library-js.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">使用命令行编译器创建 Kotlin JavaScript 库</span>
                            </a>
                    </div>
                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/docs/tutorials/javascript/working-with-modules/working-with-modules.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">Kotlin 与 JavaScript 模块使用</span>
                            </a>
                    </div>
                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/docs/tutorials/javascript/working-with-javascript.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">与 JavaScript 合用</span>
                            </a>
                    </div>

            </div>
            <div class="tree-item tree-branch js-item js-branch _closed"
                 data-id="协程">

                <div class="tree-item-title tree-branch-title js-item-title js-branch-title">
                    <div class="marker"></div>
                    <div class="text">协程</div>
                </div>

                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/docs/tutorials/coroutines-basic-jvm.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">JVM 平台的 Kotlin 协程简介</span>
                            </a>
                    </div>

            </div>
            <div class="tree-item tree-branch js-item js-branch _closed"
                 data-id="Web 开发">

                <div class="tree-item-title tree-branch-title js-item-title js-branch-title">
                    <div class="marker"></div>
                    <div class="text">Web 开发</div>
                </div>

                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/docs/tutorials/httpservlets.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">用 Http Servlets 创建 web 应用</span>
                            </a>
                    </div>
                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/docs/tutorials/spring-boot-restful.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">用  Spring Boot 创建 RESTful Web 服务</span>
                            </a>
                    </div>

            </div>
            <div class="tree-item tree-branch js-item js-branch _opened"
                 data-id="移动开发">

                <div class="tree-item-title tree-branch-title js-item-title js-branch-title">
                    <div class="marker"></div>
                    <div class="text">移动开发</div>
                </div>

                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/docs/tutorials/kotlin-android.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">Android 开发入门</span>
                            </a>
                    </div>
                    <div class="tree-item tree-leaf js-item js-leaf">
                            <div class="tree-item-title tree-leaf-title js-item-title js-leaf-title is_active">
                                <div class="marker"></div>
                                <div class="text">Kotlin Android 扩展</div>
                            </div>
                    </div>

            </div>
            <div class="tree-item tree-branch js-item js-branch _closed"
                 data-id="工具">

                <div class="tree-item-title tree-branch-title js-item-title js-branch-title">
                    <div class="marker"></div>
                    <div class="text">工具</div>
                </div>

                    <div class="tree-item tree-leaf js-item js-leaf">
                            <a href="/docs/tutorials/kotlin-and-ci.html"
                               class="tree-item-title tree-leaf-title js-item-title js-leaf-title"
                            >
                                <span class="marker"></span>
                                <span class="text">TeamCity 配置 Kotlin</span>
                            </a>
                    </div>

            </div>
    </nav>

            </div>
        </aside>

        <article role="main" class="page-content g-9">
<a href="https://github.com/hltj/kotlin-web-site-cn/edit/master/pages/docs/tutorials/android-plugin.md"
   class="page-link-to-github"
   target="_blank"
   title="Edit this page on GitHub">
        <i class="github-icon"></i>
        <span class="text">Edit Page</span>
</a>
            <h1>
                Kotlin Android Extensions
            </h1>
            <table>
                    <tr>
                        <td>
                            <strong>Author</strong>
                        </td>
                        <td>
                            Yan Zhulanow
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <strong>Last Updated</strong>
                        </td>
                        <td>
                            18 March 2015
                        </td>
                    </tr>
            </table>
                This tutorial describes how to use Kotlin Android Extensions to improve support for Android development.
                <br/>
                <br/>
            
<p>In this tutorial we'll walk through the steps required to use the Kotlin Android Extensions plugin, enhancing the development experience with Android.</p>
<h3 id="background">Background</h3>
<p>Every Android developer knows well the <code>findViewById()</code> function. It is, without a doubt, a source of potential bugs and nasty code which is hard to read and support.
While there are several libraries available that provide solutions to this problem, being libraries dependent on runtime, they require annotating fields for each <code>View</code>.</p>
<p>The Kotlin Android Extensions plugin allows us to obtain the same experience we have with some of these libraries, without having to add any extra code or shipping any additional runtime.</p>
<p>In essence, this would allow for the following code:</p>
<pre><code class="code _highlighted" data-lang="text/x-kotlin">// Using R.layout.activity_main from the main source set
import kotlinx.android.synthetic.main.activity_main.*

class MyActivity : Activity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)
        textView.setText("Hello, world!")
        // Instead of findView(R.id.textView) as TextView
    }
}
</code></pre>
<p><code>textView</code> is an extension property for <code>Activity</code>, and it has the same type as declared in <code>activity_main.xml</code>.</p>
<h3 id="using-kotlin-android-extensions">Using Kotlin Android Extensions</h3>
<h4 id="configuring-the-dependency">Configuring the dependency</h4>
<p>In this tutorial we're going to be using Gradle but the same can be accomplished using either IntelliJ IDEA project structure or Maven. For details on setting up Gradle to work with Kotlin, see <a href="/docs/reference/using-gradle.html">Using Gradle</a>.</p>
<p>Android Extensions is a part of the Kotlin IDEA plugin. You do not need to install additional plugins.</p>
<p>All you need is to enable the Android Extensions Gradle plugin in your project-local <code>build.gradle</code> file:</p>
<pre><code class="code _highlighted" data-lang="text/x-groovy">apply plugin: 'kotlin-android-extensions'
</code></pre>
<h4 id="importing-synthetic-properties">Importing synthetic properties</h4>
<p>It is convenient to import all widget properties for a specific layout in one go:</p>
<pre><code class="code _highlighted" data-lang="text/x-kotlin">import kotlinx.android.synthetic.main.&lt;layout&gt;.*
</code></pre>
<p>Thus if the layout filename is <code>activity_main.xml</code>, we'd import <code>kotlinx.android.synthetic.main.activity_main.*</code>.</p>
<p>If we want to call the synthetic properties on <code>View</code> (useful in adapter classes), we should also import <code>kotlinx.android.synthetic.main.activity_main.view.*</code>.</p>
<p>Once we do that, we can then invoke the corresponding extensions, which are properties named after the views in the XML file. 
For example, for this view:</p>
<pre><code class="code _highlighted" data-lang="application/xml">    &lt;TextView
            android:id="@+id/hello"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="Hello World, MyActivity"
            /&gt;
</code></pre>
<p>There will be property named <code>hello</code>:</p>
<pre><code class="code _highlighted" data-lang="text/x-kotlin">activity.hello.setText("Hi!")
</code></pre>
<h3 id="android-flavors">Android Flavors</h3>
<p>Android Extensions plugin supports Android flavors. Suppose you have a flavor named <code>free</code> in your <code>build.gradle</code> file:</p>
<pre><code>android {
    productFlavors {
        free {
            versionName "1.0-free"
        }
    }
}
</code></pre>
<p>So you can import all synthetic properties for the <code>free/res/layout/activity_free.xml</code> layout by adding this import:</p>
<pre><code class="code _highlighted" data-lang="text/x-kotlin">import kotlinx.android.synthetic.free.activity_free.*
</code></pre>
<h3 id="under-the-hood">Under the hood</h3>
<p>Kotlin Android Extensions is a plugin for the Kotlin compiler, and it does two things:</p>
<ol>
<li>Adds a hidden caching function and a field inside each Kotlin <code>Activity</code>. The method is pretty small so it doesn't increase the size of APK much.</li>
<li>Replaces each synthetic property call with a function call.</li>
</ol>
<p>How this works is that when invoking a synthetic property, where the receiver is a Kotlin Activity/Fragment class that is in module sources, the caching function is invoked.
For instance, given</p>
<pre><code class="code _highlighted" data-lang="text/x-kotlin">class MyActivity: Activity()
fun MyActivity.a() { 
        this.textView.setText(“”) 
}
</code></pre>
<p>a hidden caching function is generated inside MyActivity, so we can use the caching mechanism.</p>
<p>However in the following case:</p>
<pre><code class="code _highlighted" data-lang="text/x-kotlin">fun Activity.b() { 
        this.textView.setText(“”)     
}
</code></pre>
<p>We wouldn't know if this function would be invoked on only Activities from our sources or on plain Java Activities also. As such, we don’t use caching there, even
if MyActivity instance from the previous example is the receiver.</p>

        </article>
    </div>
    </div>

</div>

<footer role="contentinfo" class="global-footer">

    <div class="global-footer-terms">
        <div class="g-layout">

            <div class="terms-copyright">
                &copy; 2000&ndash;2017 JetBrains. All rights reserved
            </div>

            <div class="terms-sponsor">
            Sponsored and developed by <a href="http://jetbrains.com" class="sponsor sponsor_jetbrains" target="_blank">JetBrains</a>
            由<a href="http://github.com/hltj" class="testimonial-company-link" target="_blank" rel="nofollow">灰蓝天际</a>、<a href="http://tanfujun.com" class="testimonial-company-link" target="_blank" rel="nofollow">晓_晨DEV</a> <a href="https://github.com/cctanfujun/kotlin-web-site-cn#翻译进度" class="testimonial-company-link" target="_blank" rel="nofollow">等</a>译
            </div>
        </div>
    </div>

</footer>
</body>
</html>